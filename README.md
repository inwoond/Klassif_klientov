# Проект: Классификация клиентов телеком-оператора

## Описание проекта

Оператор связи **«ТелеДом»** стремится сократить отток клиентов. Для этого необходимо заранее определять тех абонентов, которые с высокой вероятностью могут отказаться от услуг. Цель проекта — построить модель машинного обучения, которая по данным о клиентах, их тарифах и активности предсказывает факт расторжения договора.

## Постановка задачи

- Провести исследовательский анализ данных (EDA)
- Выявить факторы, влияющие на решение клиента прекратить сотрудничество.
- Построить модель предсказания оттока клиентов.
- Проверить модель на тестовых данных.

## Описание данных

База данных находится в формате **SQLite** и содержит 4 основные таблицы:

- `contract` — информация о типе договора, сроках, стоимости услуг, регулярности платежей.
- `personal` — демографические и личные данные (пол, пенсионный статус, брак, наличие детей).
- `internet` — сведения об интернет-услугах (тип подключения, наличие антивируса, резервного копирования, ТВ и т.д.).
- `phone` — подключение к телефонной связи и количество линий.

Некоторые особенности:

- Есть клиенты с нулевыми расходами (подписались, но не пользовались).
- Часть клиентов использует комбинированные услуги (интернет + телефон).

## Как решалась задача

### 1. Загрузка и анализ данных

- Все таблицы были успешно импортированы.
- Проверены размеры таблиц, первичные ключи и совместимость по ID.
- Выявлены особенности: дата выгрузки данных, сезонный рост числа контрактов, преобладание помесячной оплаты.

### 2. Исследовательский анализ (EDA)

#### `contract`:
- Большинство клиентов используют **месячный** тариф.
- Самые дешёвые тарифы — самые популярные.
- Отток чаще наблюдается среди тех, кто платит помесячно.

#### `personal`:
- Гендерное распределение почти равномерное.
- Лишь 15% — пенсионеры.
- Около половины клиентов состоят в браке, большинство — без детей.

#### `phone`:
- Почти у 50% клиентов подключено **несколько телефонных линий**.

#### `internet`:
- Используются два типа подключения: DSL и Fiber Optic.
- Часть клиентов отказывается от дополнительных опций (безопасность, поддержка).

### 3. Объединение таблиц

- Создан единый датафрейм на основе всех таблиц по ключу `customer_id`.
- Для обучения моделей данные были подготовлены с учётом балнаса классов

### 4. Обучение моделей

- Обучены несколько моделей:
  - **Random Forest**
  - **CatBoostClassifier**
  - **Нейронная сеть**
  
- Проведена настройка гиперпараметров.
- Выполнен кросс-валидационный анализ и подбор лучших параметров.

По результатам обучения по метрике **ROC_AUC** лучшей оказалась модель **CatBoostClassifier**, эта модель была выбрана основной

### 5. Интерпретация результатов

- Использован **SHAP** для оценки важности признаков.
- Наиболее важные признаки:
  - Длительность контракта `contract_duration`.
  - Тип оплаты (ежемесячная/годовая). `type`

Произведён дополненительный анализ признака `contract_duration`, что дало большее представление о портрете уходящих клиентов

## Использованные технологии

- `Python`, `Pandas`, `Numpy`
- `Scikit-learn`, `CatBoost`, `RandomForest`, `MLPClassifier`
- `Matplotlib`, `Seaborn`, `SHAP`

## Результаты

- Лучшая модель: **CatBoostClassifier**
- Метрики на валидации:
  - `Accuracy`: ~0.90
  - `ROC-AUC`: ~0.90
- Модель адекватно предсказывает отток клиентов.
- Выявлены ключевые зоны риска: длительность контракта, сумма платежей, количество услуг и наличие партнёра. Клиенты с коротким сроком контракта и небольшими суммами чаще уходят.

## Выводы

- **Предсказание оттока клиентов возможно с высокой точностью.**
- Модель можно использовать для запуска **таргетированных предложений** (скидки, бонусы).
- Оператор может удерживать клиентов, оптимизируя тарифы и повышая ценность дополнительных опций.
- Для дальнейшего улучшения предлагается внедрение поведенческой аналитики (логины, частота обращений, отклики на маркетинг).
